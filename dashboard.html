<!doctype html>
<html lang="fr">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard gâteaux</title>
<link rel="stylesheet" href="assets/CSS/style.css">
<body>
  <h1>Dashboard</h1>

  <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:flex-end;">
    <div>
      <label for="cakeSelect">Gâteau</label><br>
      <select id="cakeSelect" style="min-width:260px">
        <option value="">— Sélectionner un gâteau —</option>
      </select>
    </div>

    <div>
      <label for="searchCake">Filtrer</label><br>
      <input id="searchCake" placeholder="Rechercher par titre">
    </div>

    <div>
      <label>&nbsp;</label><br>
      <button id="btnRefreshCakes" type="button">Rafraîchir la liste</button>
    </div>

    <div>
      <label>&nbsp;</label><br>
      <button id="btnLoad" type="button">Charger</button>
    </div>

    <div>
      <label>&nbsp;</label><br>
      <button id="btnExport" type="button">Export CSV</button>
    </div>
  </div>

  <!-- Bloc Lien public -->
  <div id="shareBox" style="display:none;margin-top:12px;background:#fff;padding:12px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,.05);">
    <strong>Lien public :</strong>
    <a id="publicLinkDash" href="#" target="_blank" rel="noopener"></a>
    <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
      <button type="button" id="btnCopyLink">Copier le lien</button>
      <button type="button" id="btnWhatsApp">Partager WhatsApp</button>
    </div>
    <div id="qrDash" style="margin-top:8px;"></div>
    <!-- Optionnel: si tu veux le QR
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    -->
  </div>

  <h2>Statistiques</h2>
  <p>Moyenne globale : <strong id="avgGlobal">-</strong></p>
  <ul>
    <li>Goût : <span id="avgTaste">-</span></li>
    <li>Texture : <span id="avgTexture">-</span></li>
    <li>Garniture / Accord : <span id="avgPairing">-</span></li>
    <li>Visuel : <span id="avgVisuel">-</span></li>
    <!-- Remarque : l’“Impression générale” est incluse dans les graphiques et le tableau.
         Si tu veux aussi l’afficher ici, ajoute <li>Impression générale : <span id="avgIG">-</span></li>
         et je mettrai à jour main.js pour le renseigner. -->
  </ul>

  <h2>Graphiques</h2>
  <div style="background:#fff;padding:16px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,.05);">
    <h3>Moyennes par critère (/10)</h3>
    <canvas id="chartAverages" height="120"></canvas>
  </div>

  <div style="height:12px"></div>

  <div style="background:#fff;padding:16px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,.05);">
    <h3>Distribution des notes globales</h3>
    <canvas id="chartHistogram" height="120"></canvas>
  </div>

  <div style="height:12px"></div>

  <div style="background:#fff;padding:16px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,.05);">
    <h3>Observations (flags)</h3>
    <canvas id="chartFlags" height="120"></canvas>
  </div>

  <h2>Réponses</h2>
  <table border="1" cellpadding="6">
    <thead>
      <tr>
        <th>Testeur</th>
        <th>Goût</th>
        <th>Texture</th>
        <th>Garniture / Accord</th>
        <th>Visuel</th>
        <th>Impression générale</th>
        <th>Globale</th>
        <th>Observations</th>
        <th>Commentaire</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody id="responsesTbody"></tbody>
  </table>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="assets/JS/config.js"></script>
  <script src="assets/JS/diagnostics.js"></script> <!-- optionnel ; s’active seulement si ENV === "TEST" -->
  <script src="assets/JS/main.js"></script>
</body>
</html>
